{% extends 'quotes/base.html' %}

{% block title %}–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞ - –¶–∏—Ç–∞—Ç–Ω–∏–∫{% endblock %}

{% block header %}–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞{% endblock %}

{% block content %}
    {% if quote %}
    <div class="quote">
        <blockquote>{{ quote.text }}</blockquote>
        <p class="source">- {{ quote.source.name }} ({{ quote.source.get_type_display }})</p>
        <p class="stats">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {{ quote.views }} | –õ–∞–π–∫–æ–≤: {{ quote.likes }} | –î–∏–∑–ª–∞–π–∫–æ–≤: {{ quote.dislikes }}</p>
        
        <div class="buttons">
            <button onclick="likeQuote({{ quote.id }})">üëç {{ quote.likes }}</button>
            <button onclick="dislikeQuote({{ quote.id }})">üëé {{ quote.dislikes }}</button>
        </div>
    </div>
    {% else %}
    <div class="no-quotes">
        <p>–¶–∏—Ç–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç. <a href="{% url 'add_quote' %}">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é</a></p>
    </div>
    {% endif %}
{% endblock %}

{% block scripts %}
<script>
function likeQuote(quoteId) {
    fetch(`/like/${quoteId}/`)
        .then(response => response.json())
        .then(data => {
            document.querySelector(`button[onclick="likeQuote(${quoteId})"]`).textContent = `üëç ${data.likes}`;
            document.querySelector(`button[onclick="dislikeQuote(${quoteId})"]`).textContent = `üëé ${data.dislikes}`;
        });
}

function dislikeQuote(quoteId) {
    fetch(`/dislike/${quoteId}/`)
        .then(response => response.json())
        .then(data => {
            document.querySelector(`button[onclick="likeQuote(${quoteId})"]`).textContent = `üëç ${data.likes}`;
            document.querySelector(`button[onclick="dislikeQuote(${quoteId})"]`).textContent = `üëé ${data.dislikes}`;
        });
}
</script>
{% endblock %}